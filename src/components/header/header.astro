---
import { promises as fs } from "fs";
import { NavItems } from "../nav-items";
import HeaderActions from "./header-actions.astro";
import HeaderLogo from "./header-logo.astro";

import { getCollection } from "astro:content";

const days = await getCollection("days");

const links = JSON.parse(
  await fs.readFile(new URL("../../data/links.json", import.meta.url), "utf-8"),
);

// big assumption that programme is the first section

links.header[0].items = [
  {
    name: "Schedule",
    path: `/schedule/${days[0].id}`,
  },

  ...links.header[0].items,
];
---

<header class="p-6 flex items-center relative z-40">
  <input
    type="checkbox"
    name="mobile-controls"
    id="nav_toggle"
    class="hidden peer"
    aria-hidden="true"
  />

  <HeaderLogo />

  <nav class="mr-auto hidden xl:block">
    <NavItems items={links.header} />
  </nav>

  <HeaderActions />

  <div
    class="fixed bg-body-background top-0 left-0 w-screen h-screen overflow-scroll hidden peer-checked:block xl:peer-checked:hidden z-50 p-6"
  >
    <div class="flex items-center">
      <HeaderLogo />
      <HeaderActions mobile />
    </div>

    <nav class="mt-8">
      <NavItems
        items={[
          {
            name: "Code of Conduct",
            path: "https://www.europython-society.org/coc/",
          },
          /*
            {
              name: "Live ðŸ“º",
              path: "/live",
            },
            */
          {
            name: "Buy tickets",
            path: "/tickets",
          },
          ...links.header,
        ]}
      />
    </nav>
  </div>
</header>
